%%{init: {
  'theme': 'neutral',
  'themeVariables': {
    'primaryColor': '#f0f4f8',
    'primaryTextColor': '#333',
    'primaryBorderColor': '#8fa7b8',
    'lineColor': '#8fa7b8',
    'secondaryColor': '#f8f0f4',
    'tertiaryColor': '#f4f8f0',
    'fontFamily': 'Trebuchet MS, Arial, sans-serif',
    'fontSize': '12px'
  }
}}%%

graph TD
    classDef default fill:#fff,stroke:#8fa7b8,stroke-width:3px;
    classDef config fill:#f9efd4,color:#333,stroke:#d4b26a;
    classDef core fill:#d4e6f1,color:#333,stroke:#7fb3d5;
    classDef agent fill:#d5f5e3,color:#333,stroke:#82e0aa;
    classDef task fill:#fdebd0,color:#333,stroke:#f5b041;
    classDef factory fill:#e8daef,color:#333,stroke:#bb8fce;
    classDef strategy fill:#d6eaf8,color:#333,stroke:#85c1e9;
    classDef util fill:#f2d7d5,color:#333,stroke:#e6b0aa;

    subgraph "Tasks"
        direction TB
        F[SearchTask]:::task
        G[ScrapeTask]:::task
        H[SummarizeTask]:::task
    end

    subgraph "Agents"
        direction TB
        I[WebSearchAgent]:::agent
        J[WebScrapeAgent]:::agent
        K[WebContentSummarizeAgent]:::agent
    end

    subgraph "Factories"
        direction TB
        O[GenerationStrategy Factory]:::factory
        P[ModelFactory Provider]:::factory
        S[TaskFactory]:::factory
        Q[DefaultGeneration Strategy]:::factory
        R[VertexAIModel Factory]:::factory
    end

    T[serp.py]:::util

    F -- "implemented by" --> I
    G -- "implemented by" --> J
    H -- "implemented by" --> K

    I -- "uses" --> M[ResponseGenerator]:::core
    J -- "uses" --> M
    K -- "uses" --> M

    M -- "interacts with" --> O
    M -- "interacts with" --> P
    O -- "creates" --> Q
    P -- "creates" --> R

    S -- "generates" --> I
    S -- "generates" --> J
    S -- "generates" --> K

    T -- "accessed by" --> I
